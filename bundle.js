(()=>{"use strict";function e(){return{formEl:document.querySelector(".search-form"),galleryEl:document.querySelector(".gallery")}}const t=document.querySelector(".backDrop"),s=document.querySelector(".content"),{galleryEl:n}=e();t.addEventListener("click",(function(e){e.preventDefault(),e.target===e.currentTarget&&(s.innerHTML="",t.classList.add("is-hidden"))})),n.addEventListener("click",(function(e){e.preventDefault(),"IMG"===e.target.nodeName&&(t.classList.remove("is-hidden"),function(e){const t=`<img src=${e} alt="photo" />`;s.insertAdjacentHTML("beforeend",t)}(e.target.dataset.source))}));const a=e=>{const{webformatURL:t,tags:s,largeImageURL:n,likes:a,views:i,comments:r,downloads:o}=e;return`\n        <li class="img-card">\n        <div class="img-card-wrap">\n            <img src=${t} alt="${s}" data-source=${n} class="image"/>\n        </div>\n            <div class="stats-list">\n                <div class="stat-item">\n                    <i class="material-icons">thumb_up</i>\n                   <span> ${a}</span>\n                </div>\n                <div class="stat-item">\n                    <i class="material-icons">visibility</i>\n                 <span>   ${i}</span>\n                </div>\n                <div class="stat-item">\n                    <i class="material-icons">comment</i>\n                <span>    ${r}</span>\n                </div>\n                <div class="stat-item">\n                    <i class="material-icons">cloud_download</i>\n                 <span>   ${o} </span>\n                </div>\n            </div>\n        \n        </li>\n    `},{formEl:i,galleryEl:r}=e(),o=new class{constructor(){this.searchQuery="",this.page=1,this.totalImages=!0,this.loading=!1}async fetchArticles(){this.loading=!0;try{const e=await fetch(`https://api-for-finder.onrender.com/proxy?searchQuery=${this.searchQuery}&page=${this.page}&limit=8`);if(!e.ok)throw new Error("Error fetching data");return await e.json()}catch(e){console.log(e)}finally{this.loading=!1}}get query(){return this.searchQuery}set query(e){this.searchQuery=e}get total(){this.totalImages}set total(e){this.totalImages=e}incrementPage(){this.page+=1}decrementPage(){this.page-=1}resetPage(){this.page=1}},c=new class{constructor({selector:e,hidden:t=!1}){this.refs=this.getRefs(e),t&&this.hide()}getRefs(e){const t={};return t.button=document.querySelector(e),t.label=t.button.querySelector(".label"),t}enable(){this.refs.button.disabled=!1,this.refs.label.textContent="Load more"}disable(){this.refs.button.disabled=!0,this.refs.label.textContent="Loading..."}show(){this.refs.button.classList.remove("is-hidden")}hide(){this.refs.button.classList.add("is-hidden")}}({selector:'[data-action="Loader more"]',hidden:!0});function l(e){return e.map(a).join("")}function d(e){return r.insertAdjacentHTML("beforeend",e)}console.log(c),i.addEventListener("submit",(async function(e){e.preventDefault();const t=e.currentTarget.elements.query.value;if(!t)return alert("please enter search query");try{r.innerHTML="",console.log("clear"),o.resetPage(),o.query=t;const e=await o.fetchArticles();console.log(e);const{hits:s,totalHits:n}=e;o.incrementPage(),d(l(s)),c.show()}catch(e){console.log(e)}finally{i.reset()}})),c.refs.button.addEventListener("click",(async function(e){e.preventDefault(),c.disable();try{const e=await o.fetchArticles();console.log(e);const{hits:t,totalHits:s}=e;o.incrementPage(),d(l(t))}catch(e){console.log(e)}finally{c.enable()}}))})();